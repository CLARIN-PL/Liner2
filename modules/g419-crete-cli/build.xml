<?xml version="1.0"?>
<project name="g419-crete-cli -- konsolowy interfejs dla g419-crete-api" default="compile" basedir=".">

	<property name="build_path" value="build" />
	
	<taskdef resource="net/sf/antcontrib/antcontrib.properties">
	  <classpath>
	    <pathelement location="../../lib/ant-contrib-1.0b3.jar"/>
	  </classpath>
	</taskdef>
	
	<path id="classpath.standard">
		<pathelement location="../../lib/commons-cli-1.2.jar"/>
		<pathelement location="../../lib/commons-io-2.4.jar"/>
		<pathelement location="../../lib/weka-3.6.12.jar"/>
		<pathelement location="../../lib/jlibsvm-0.92-SNAPSHOT.jar"/>
		<pathelement location="../g419-corpus/g419-corpus.jar"/>
		<pathelement location="../g419-tools/g419-tools.jar"/>
		<pathelement location="../g419-liner2-api/g419-liner2-api.jar"/>
		<pathelement location="../g419-lib-cli/g419-lib-cli.jar"/>
		<pathelement location="../g419-crete-api/g419-crete-api.jar"/>
	</path>
	
	<target name="clean">
		<delete dir="${build_path}"/>
	</target>

	<target name="compile" depends="clean">
		<mkdir dir="${build_path}"/>
		<mkdir dir="${build_path}/lib"/>					
		<mkdir dir="${build_path}/classes"/>
				
	    <if>
	        <available file="../g419-crete-api/g419-crete-api.jar"/>
	    	<else>
	    		<echo message="Compiling g419-crete-api.jar ..."/>
	            <exec dir="../g419-crete-api" executable="ant">
	        		<arg line="jar"/>
	        	</exec>
	        </else>
	    </if>

    	<if>
	        <available file="../g419-liner2-api/g419-liner2-api.jar"/>
	    	<else>
	    		<echo message="Compiling g419-liner2-api.jar ..."/>
	            <exec dir="../g419-liner2-api" executable="ant">
	        		<arg line="jar"/>
	        	</exec>
	        </else>
	    </if>
		
	    <if>
	        <available file="../g419-lib-cli/g419-lib-cli.jar"/>
	    	<else>
	    		<echo message="Compiling g419-lib-cli.jar ..."/>
	            <exec dir="../g419-lib-cli" executable="ant">
	        		<arg line="jar"/>
	        	</exec>
	        </else>
	    </if>

		<javac 
				srcdir="src"
				optimize="on" 
				debug="yes" 
				debuglevel="source,lines,vars" 
				destdir="build/classes" 
				includeantruntime="false">
    		<compilerarg value="-Xlint:all"/>
    		<classpath refid="classpath.standard"/>
  		</javac>
	</target>

	<target name="jar" depends="compile">
		<manifest file="MANIFEST.MF">
    		<attribute name="Built-By" value="${user.name}"/>
			<attribute name="Main-Class" value="g419.crete.cli.Main"/>
			<attribute name="Class-Path" value="
				./commons-cli-1.2.jar
				./commons-lang3-3.3.2.jar
				./commons-io-2.4.jar
				./ini4j-0.5.0.jar
				./weka-3.6.12.jar
				./g419-corpus.jar
				./g419-lib-cli.jar
				./g419-liner2-api.jar
				./g419-crete-api.jar"/>			
   		</manifest>

		<jar destfile="g419-crete-cli.jar" manifest="MANIFEST.MF">
    		<fileset dir="${build_path}/classes" includes="**/*.class"/>
  		</jar>
                
		<delete file="MANIFEST.MF"/>
		<delete dir="bin"/>
		<delete dir="build"/>
	</target>
			
</project>
