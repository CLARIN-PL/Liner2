<?xml version="1.0"?>

<project name="Liner2 -- Light Named Entity Recognizer" default="make" basedir=".">

	<property name="release" value="liner2-1" />
	<property name="path_nerd" value="../../workspace_inforex/inforex_nerd" />
	<property name="path_models" value="../models" />
	<property name="path_production" value="/nlp/eclipse/workspace_liner2/package/${release}" />

	<target name="clean">
  		<delete dir="${path_production}"/>
	</target>

	<target name="make" depends="clean,copy-liner,copy-nerd,copy-models,compress"/>		

	<target name="copy-liner">
		<mkdir dir="${path_production}"/>
		<exec executable="cp">
			<arg value="./external"/>
			<arg value="${path_production}/external"/>
			<arg value="-R"/>
		</exec>		
		<copy todir="${path_production}/lib" >  
			<fileset dir="./lib" includes="**"/>  
		</copy>
		<copy todir="${path_production}/src" >  
			<fileset dir="./src" includes="**"/>
		</copy>
		<copy todir="${path_production}/test" >  
			<fileset dir="./test" includes="**"/>
		</copy>
		<copy file="./build.xml" todir="${path_production}"/>
		<copy file="./liner2.sh" todir="${path_production}"/>
		<chmod file="${path_production}/liner2.sh" perm="a+x"></chmod>
		<copy file="./INSTALL" todir="${path_production}"/>
		<copy file="./LICENSE" todir="${path_production}"/>
		<copy file="./README" todir="${path_production}"/>
		<echo file="${path_production}/local.ini"># Common configuration
-nerd {INI_PATH}/nerd
-ini {INI_PATH}/model-5nam-v1/model.ini
		</echo> 
	</target>

	<target name="copy-nerd">
		<mkdir dir="${path_production}/nerd"/>
		<exec executable="git" dir="${path_nerd}/">
			<arg value="checkout-index"/>
			<arg value="-f"/>
			<arg value="-a"/>
			<arg value="--prefix=${path_production}/nerd/"/>
		</exec>
	</target>

	<target name="copy-models">
		<copy todir="${path_production}/model-5nam-v1" >  
			<fileset dir="${path_models}/model-5nam-v1" includes="**"/>  
		</copy>		
	</target>

	<target name="compress">
		<exec executable="rm">
			<arg value="/nlp/eclipse/workspace_liner2/package/${release}.7z"/>
		</exec>
		<exec executable="7z">
			<arg value="a"/>
			<arg value="/nlp/eclipse/workspace_liner2/package/${release}.7z"/>
			<arg value="/nlp/eclipse/workspace_liner2/package/${release}"/>
		</exec>				
	</target>

</project>
